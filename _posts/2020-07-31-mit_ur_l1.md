---
layout: mathpost
title:  "6.832 Underactuated Robotics - Lecture 1"
mathjax: true
tags: [math, control, robotics]
local: false
---
# [Video Lecture](https://youtu.be/VeEqtTgDXFc)

# Deriving the Manipulator Equations
State $q = \begin{bmatrix}\theta_1 \\\ \theta_2\end{bmatrix}$.

Positions of masses $m_1$ and $m_2$ are:

$$
p_1 = l_1\begin{bmatrix}s_1 \\\ -c_1 \end{bmatrix}
$$

$$
p_2 = p_1 + l_2\begin{bmatrix}s_{1+2} \\\ -c_{1+2} \end{bmatrix}
$$

Velocities are:

$$
\dot p_1 = l_1 \dot\theta_1 \begin{bmatrix}c_1 \\\ s_1 \end{bmatrix}
$$

$$
\dot p_2 = \dot p_1 + l_2 \left(\dot\theta_1 + \dot\theta_2\right) \begin{bmatrix}c_{1+2} \\\ s_{1+2} \end{bmatrix}
$$

Total kinetic energy

$$
\begin{align*}
T &= \frac{1}{2}m_1 \dot p_1^T \dot p_1 + \frac{1}{2}m_2 \dot p_2^T \dot p_2\\
&= \frac{1}{2}m_1 \dot p_1^T \dot p_1 +
\frac{1}{2}m_2 \left(
    \dot p_1^T \dot p_1 +
    2 l_2 \left(\dot\theta_1 + \dot\theta_2\right) \dot p_1^T \begin{bmatrix}c_{1+2} \\\ s_{1+2} \end{bmatrix} +
    l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2
\right)\\
&= \frac{1}{2} (m_1 + m_2) l_1^2 \dot \theta_1^2 +
m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right) (c_1 c_{1+2} + s_1 s_{1+2}) +
\frac{1}{2} m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2 \\
&= \frac{1}{2} (m_1 + m_2) l_1^2 \dot \theta_1^2 +
c_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right)+
\frac{1}{2} m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2
\end{align*}
$$

Total potential energy

$$
\begin{align*}
U &= m_1 g y_1 + m_2 g y_2\\
&=-g\left(m_1 l_1 c_1 + m_2(l_1 c_1 + l_2 c_{1+2}) \right)
\end{align*}
$$

The Lagrangian is $L = T - U$

## [Lagrangian equation of the first kind](https://en.wikipedia.org/wiki/Lagrangian_mechanics) for $\theta_1$:

$$
\dv{}{t} \pdv{L}{\dot \theta_1} - \pdv{L}{\theta_1} = \tau_1
$$

Now 

$$
\begin{align*}
\pdv{L}{\dot \theta_1}
&= \pdv{}{\dot \theta_1} \left[ \frac{1}{2} (m_1 + m_2) l_1^2 \dot \theta_1^2 +
c_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right)+
\frac{1}{2} m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2 + 
g\left(m_1 l_1 c_1 + m_2(l_1 c_1 + l_2 c_{1+2}) \right) \right]\\
&= (m_1 + m_2) l_1^2 \dot \theta_1 +
c_2 m_2 l_1 l_2 (2\dot\theta_1 + \dot\theta_2) +
m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)
\end{align*}
$$

Hence 

$$
\begin{align*}
\dv{}{t} \pdv{L}{\dot \theta_1}
&= \dv{}{t} \left[ (m_1 + m_2) l_1^2 \dot \theta_1 +
c_2 m_2 l_1 l_2 (2\dot\theta_1 + \dot\theta_2) +
m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right) \right] \\
&= (m_1 + m_2) l_1^2 \ddot \theta_1 +
m_2 l_2^2 \left(\ddot\theta_1 + \ddot\theta_2\right) +
m_2 l_1 l_2 (2\ddot\theta_1 + \ddot\theta_2) c_2 -
m_2 l_1 l_2 (2\dot\theta_1 + \dot\theta_2) \dot \theta_2 s_2  
\end{align*}
$$

And

$$
\begin{align*}
\pdv{L}{\theta_1}
&= \pdv{}{\theta_1} \left[ \frac{1}{2} (m_1 + m_2) l_1^2 \dot \theta_1^2 +
c_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right)+
\frac{1}{2} m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2 + 
g\left(m_1 l_1 c_1 + m_2(l_1 c_1 + l_2 c_{1+2}) \right) \right]\\
&= -g \left(m_1 l_1 s_1 + m_2 \left(l_1 s_1 + l_2 s_{1+2} \right) \right) \\
&= -(m_1 + m_2) l_1 g s_1 - m_2 g l_2 s_{1+2}
\end{align*}
$$

Hence we get the Lagrangian equation

$$
(m_1 + m_2) l_1^2 \ddot \theta_1 +
m_2 l_2^2 \left(\ddot\theta_1 + \ddot\theta_2\right) +
m_2 l_1 l_2 (2\ddot\theta_1 + \ddot\theta_2) c_2 -
m_2 l_1 l_2 (2\dot\theta_1 + \dot\theta_2) \dot \theta_2 s_2 +
(m_1 + m_2) l_1 g s_1 +
m_2 g l_2 s_{1+2} = \tau_1
$$

## Similarly, [Lagrangian equation of the first kind](https://en.wikipedia.org/wiki/Lagrangian_mechanics) for $\theta_2$:

$$
\dv{}{t} \pdv{L}{\dot \theta_2} - \pdv{L}{\theta_2} = \tau_2
$$ 

Now 

$$
\begin{align*}
\pdv{L}{\dot \theta_2}
&= \pdv{}{\dot \theta_2} \left[ \frac{1}{2} (m_1 + m_2) l_1^2 \dot \theta_1^2 +
c_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right)+
\frac{1}{2} m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2 + 
g\left(m_1 l_1 c_1 + m_2(l_1 c_1 + l_2 c_{1+2}) \right) \right]\\ 
&= c_2 m_2 l_1 l_2 \dot\theta_1 +
m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right) 
\end{align*}
$$

Hence

$$
\begin{align*}
\dv{}{t} \pdv{L}{\dot \theta_2}
&= \dv{}{t} \left[ c_2 m_2 l_1 l_2 \dot\theta_1 +
m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right) \right] \\
&= c_2 m_2 l_1 l_2 \ddot\theta_1 -
s_2 m_2 l_1 l_2 \dot\theta_1^2 +
m_2 l_2^2 \left(\ddot\theta_1 + \ddot\theta_2\right)
\end{align*}
$$

And

$$
\begin{align*}
\pdv{L}{\theta_2}
&= \pdv{}{\theta_2} \left[ \frac{1}{2} (m_1 + m_2) l_1^2 \dot \theta_1^2 +
c_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right) +
\frac{1}{2} m_2 l_2^2 \left(\dot\theta_1 + \dot\theta_2\right)^2 + 
g\left(m_1 l_1 c_1 + m_2(l_1 c_1 + l_2 c_{1+2}) \right) \right]\\
&= -s_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right) -
g m_2 l_2 s_{1+2}
\end{align*}
$$

Hence we get the Lagrangian equation

$$
c_2 m_2 l_1 l_2 \ddot\theta_1 -
s_2 m_2 l_1 l_2 \dot\theta_1^2 +
m_2 l_2^2 \left(\ddot\theta_1 + \ddot\theta_2\right) +
s_2 m_2 l_1 l_2 \dot\theta_1 \left(\dot\theta_1 + \dot\theta_2\right) +
g m_2 l_2 s_{1+2} = \tau_2
$$

This last equation is different from the lecture slides, but I can't find
anything wrong with my calculations.